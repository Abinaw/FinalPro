<div class="w-full h-full  rounded-xl p-[10px] bg-white flex gap-[10px]">
    <div
        class="border-solid pr-[20px] border-r-[2px] border-slate-300 w-[22%] h-full  rounded-l-xl pt-[35px] flex flex-col items-center ">

        <form [formGroup]="invoiceSelection" class="w-full ">
            <mat-form-field class="w-full">
                <mat-label>REPORT SELECT</mat-label>
                <mat-select formControlName="selectedOpt" name="report" class="font-mono">
                    <mat-option class="font-semibold font-mono" *ngFor="let option of reports"
                        [value]="option.value" (focus)="onReportTypeChange(option.value)">{{option.viewValue|uppercase}}</mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field class="w-full"
                *ngIf="invoiceSelection.get('selectedOpt')?.value==='allPaymentsReports'||invoiceSelection.get('selectedOpt')?.value==='customPaymentsReport'">
                <mat-label>REPROT TYPE</mat-label>
                <mat-select formControlName="reportType" class="font-mono">
                    <mat-option class="font-semibold font-mono" *ngFor="let option of reportCategory"
                        [value]="option.value">{{option.viewValue|uppercase}}</mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field class="w-full" *ngIf="invoiceSelection.get('selectedOpt')?.value==='voucherReprint'|| 
           invoiceSelection.get('selectedOpt')?.value==='customPaymentsReport' && 
           invoiceSelection.get('reportType')?.value==='purchaseInvoice'">
                <mat-label>VOUCHER REF NUMBER</mat-label>
                <input type="text" placeholder="RefNo" matInput formControlName="refNo"
                    [formControl]="purchaseInvoiceControl" [matAutocomplete]="auto">
                <mat-error class="text-sm" *ngIf="invoiceSelection.get('refNo')?.hasError">This field is required!</mat-error>
                <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
                    <mat-option class="font-semibold font-mono" *ngFor="let anItem of filterOptionPurchase | async"
                        (onSelectionChange)=" getTheSelectedInvoiceId(anItem.confirmPurchaseId) "
                        [value]="anItem.purchaseInvoice">
                        {{anItem.purchaseInvoice}} | {{anItem.vendorOBJ.vendorName}}
                    </mat-option>
                </mat-autocomplete>
            </mat-form-field>

            <mat-form-field class="w-full" *ngIf="invoiceSelection.get('selectedOpt')?.value==='receiptReprint' || 
             invoiceSelection.get('selectedOpt')?.value==='customPaymentsReport' &&
             invoiceSelection.get('reportType')?.value==='salesInvoice'
             ">
                <mat-label>RECEIPT REF NUMBER</mat-label>

                <input type="text" placeholder="RefNo" matInput formControlName="refNo"
                    [formControl]="salesInvoiceNoControl" [matAutocomplete]="auto">
                <mat-error class="text-sm" *ngIf="invoiceSelection.get('refNo')?.hasError">This field is required!</mat-error>
                <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
                    <mat-option class="font-semibold font-mono" *ngFor="let anItem of filterOptions | async"
                        (onSelectionChange)=" getTheSelectedInvoiceId(anItem.confirmInvoiceId)"
                        [value]="anItem.invoiceNumberRef">

                        {{anItem.invoiceNumberRef}} | {{anItem.customerOBJ.custName}}
                    </mat-option>
                </mat-autocomplete>
            </mat-form-field>

            <mat-form-field class="w-full" *ngIf="
                invoiceSelection.get('selectedOpt')?.value === 'allPaymentsReports' ||
                (invoiceSelection.get('selectedOpt')?.value === 'customPaymentsReport' &&
                (invoiceSelection.get('reportType')?.value === 'purchaseInvoice' || 
                invoiceSelection.get('reportType')?.value === 'salesInvoice'))">
                <mat-label>Enter a date range</mat-label>
                <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
                    <input matStartDate formControlName="start" placeholder="Start date">
                    <input matEndDate formControlName="end" placeholder="End date">
            </mat-date-range-input>

                <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-date-range-picker #picker></mat-date-range-picker>
                <mat-error class="text-sm" *ngIf="range.get('end')?.hasError">End Date is required!</mat-error>
                <mat-error class="text-sm" *ngIf="range.get('start')?.hasError">Start Date field is required!</mat-error>


            </mat-form-field>

            <!-- <p class="m-[5px]">Selected range: {{range.value | json}}</p> -->
        </form>
        <section class="w-[100%] flex flex-col gap-[5px]">
            <div class="w-full flex flex-col justify-center items-center">
                <button  mat-raised-button class="w-[95%]" color="primary" (click)="generateReport()">Generate Report</button>
            </div>
            <ng-container *ngIf="showPrintButton">
            <div class="w-full flex flex-col justify-center items-center" >
                <button [disabled]="!isReportAvailable" mat-raised-button class="w-[95%]" color="warn" (click)="printReport()"
               >Print Report</button>
            </div>
        </ng-container>
        </section>
    </div>

    <div class="border-solid w-[78%] rounded-r-xl">

        <!-- <div class="w-[100%] h-full flex items-center"> -->
        <ng-container *ngIf="isReportGenerated && this.invoiceSelection.get('selectedOpt')?.value=='voucherReprint'">
            <div class="flex items-center justify-center w-full" style="height: 100vh;">
                <div class="table-cont flex flex-row items-center justify-center h- w-full overflow-auto ">
                    <ag-grid-angular class="ag-theme-alpine user-table cursor-pointer border-solid border-4"
                        [paginationAutoPageSize]="true" style="margin-bottom: 1rem; height: 52vh; width: 75vw"
                        [rowData]="purchaseInvoiceRowData$ | async" [columnDefs]="voucherDef"
                        [rowSelection]="rowSelection" (cellClicked)="onCellClicked($event)"
                        (gridReady)="onGridVoucherDataReady($event)" [pagination]="true">
                    </ag-grid-angular>
                </div>
            </div>
        </ng-container>


        <ng-container *ngIf="isReportGenerated && this.invoiceSelection.get('selectedOpt')?.value=='receiptReprint'">
            <div class="flex items-center justify-center w-full" style="height: 100vh;">

                <ag-grid-angular class="ag-theme-alpine user-table cursor-pointer border-solid border-4"
                    [paginationAutoPageSize]="true" style="margin-bottom: 1rem; height: 52vh; width: 75vw"
                    [rowData]="salesInvoiceRowData$ | async" [columnDefs]="receiptDef" [rowSelection]="rowSelection"
                    (cellClicked)="onCellClicked($event)" (gridReady)="onGridReceiptDataReady($event)"
                    [pagination]="true">
                </ag-grid-angular>
            </div>
        </ng-container>
        <!-- </div> -->
        <ng-container *ngIf="!isReportGenerated" class="">
            <div class="w-full h-full grid justify-center align-middle items-center">
                <app-empty-report></app-empty-report>
            </div>
        </ng-container>
        <ng-container *ngIf=" isReportGenerated && invoiceSelection.get('selectedOpt')?.value==='allPaymentsReports' || 
         (invoiceSelection.get('selectedOpt')?.value === 'customPaymentsReport' &&
        (invoiceSelection.get('reportType')?.value === 'purchaseInvoice' || 
         invoiceSelection.get('reportType')?.value === 'salesInvoice'))">
            <div class="w-full h-full  overflow-auto">
                <app-report-template id="printSection" [inputData]="dataToSet"></app-report-template>
            </div>
        </ng-container>
    </div>
</div>